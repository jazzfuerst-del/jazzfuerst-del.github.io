<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chasse au trésor</title>
  <meta name="color-scheme" content="light dark">
  <style>
    :root{
      --bg:#0b1020; --fg:#eef1f7; --muted:#9aa3b2; --card:#121a33;
      --accent:#7c5cff; --ok:#22c55e; --err:#ef4444; --ring:rgba(124,92,255,.3);
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#f6f7fb; --fg:#141824; --muted:#606b80; --card:#ffffff; --ring:rgba(124,92,255,.2); }
      body{ background:linear-gradient(180deg,#fbfbff,#eef1ff 25%,#f6f7fb); }
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      color:var(--fg);
      min-height:100svh;
      display:grid;
      place-items:center;
      padding:24px;
      background:
        radial-gradient(80vw 80vw at 10% 10%, rgba(124,92,255,.08), transparent 40%),
        radial-gradient(70vw 70vw at 90% 0%, rgba(34,197,94,.09), transparent 45%),
        radial-gradient(70vw 70vw at 50% 100%, rgba(59,130,246,.08), transparent 45%),
        var(--bg);
    }
    .shell{width:min(820px,100%)}
    .card{
      background:var(--card);
      border:1px solid rgba(255,255,255,.08);
      border-radius:20px;
      box-shadow:0 10px 30px rgba(2,6,23,.25);
      padding:28px;
      position:relative;
      overflow:hidden;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(124,92,255,.12);
      color:#6b5cff;
      font-weight:600;
      font-size:.85rem;
    }
    h1{
      font-size:clamp(1.4rem,1.1rem+2vw,2.2rem);
      margin:12px 0 4px;
      letter-spacing:.3px;
    }
    .subtitle{color:var(--muted);margin:0 0 16px;font-size:1rem;line-height:1.4}
    .riddle{font-size:1.125rem;line-height:1.6;margin:16px 0 18px}

    .inputRow{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    input[type=text]{
      flex:1;
      min-width:200px;
      padding:14px 14px;
      border-radius:12px;
      border:1px solid rgba(124,92,255,.25);
      outline:0;
      font-size:1rem;
      background:transparent;
      color:var(--fg);
      box-shadow:0 0 0 0 rgba(0,0,0,0);
    }
    input[type=text]:focus{box-shadow:0 0 0 6px var(--ring)}
    button.btn{
      padding:12px 16px;
      border-radius:12px;
      border:0;
      font-weight:600;
      cursor:pointer;
      background:linear-gradient(180deg,var(--accent),#5c3bff);
      color:white;
      box-shadow:0 6px 16px rgba(92,59,255,.45);
    }
    button.linkLike{
      background:transparent;
      color:var(--accent);
      box-shadow:none;
      border:0;
      padding:6px 8px;
      font-weight:600;
      cursor:pointer;
    }
    .rowBetween{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
      align-items:center;
      justify-content:space-between;
      color:var(--muted);
      font-size:.95rem
    }
    .msg{margin-top:14px;font-weight:600}
    .msg.ok{color:var(--ok)}
    .msg.err{color:var(--err)}

    .section{display:none}
    .section.active{display:block}

    .bigText{
      font-size:1.05rem;
      line-height:1.6;
      color:var(--fg);
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px;
      padding:16px;
    }

    .footer{margin-top:22px;color:var(--muted);font-size:.9rem}

    /* confetti */
    .confetti{position:absolute;inset:0;pointer-events:none;}
    .confetti i{
      position:absolute;
      width:8px;
      height:14px;
      border-radius:2px;
      opacity:0;
      animation:pop 1.2s ease-out forwards;
    }
    @keyframes pop{
      0%{transform:translate(var(--x,0),0) rotate(0);opacity:1}
      100%{transform:translate(var(--x,0),-160px) rotate(1turn);opacity:0}
    }

    .sr-only{
      position:absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      border:0;
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="card" id="card">
      <span class="pill">Étape <span id="stepLabel">?</span></span>
      <h1 id="screenTitle">…</h1>
      <p class="subtitle" id="screenSubtitle">…</p>

      <!-- ===================== -->
      <!-- ÉCRAN 1 : ÉNIGME      -->
      <!-- ===================== -->
      <section id="screen-riddle" class="section">
        <p class="riddle" id="riddleText">Chargement…</p>

        <div class="inputRow">
          <label class="sr-only" for="answer">Votre réponse</label>
          <input id="answer" type="text" autocomplete="off" placeholder="Votre réponse" />
          <button class="btn" id="submitAnswer">Valider</button>
        </div>

        <div class="rowBetween">
          <span id="attempts">0 tentative</span>
          <button class="linkLike" id="hintBtn">Besoin d'un indice ?</button>
        </div>

        <div class="msg" id="msg" aria-live="polite"></div>
      </section>

      <!-- ===================== -->
      <!-- ÉCRAN 2 : BRIEFING    -->
      <!-- ===================== -->
      <section id="screen-briefing" class="section">
        <div class="bigText" id="briefingText">
          <!-- rempli dynamiquement -->
        </div>

        <button class="btn" style="margin-top:20px;width:100%" id="goToDestination">
          Voir la prochaine étape
        </button>
      </section>

      <!-- ===================== -->
      <!-- ÉCRAN 3 : DESTINATION -->
      <!-- ===================== -->
      <section id="screen-destination" class="section">
        <div class="bigText" id="destinationText">
          <!-- rempli dynamiquement -->
        </div>
      </section>

      <div class="footer">
        <span id="footerInfo">• Bonne chance !</span>
      </div>

      <div class="confetti" id="confetti" aria-hidden="true"></div>
    </div>
  </div>

  <script>
    /*
     * CONFIGURATION
     *
     * Tu définis ici chaque étape du jeu.
     *
     * Par exemple step "1", "2", etc.
     *
     * Pour chaque step :
     * - riddleTitle     : titre affiché sur l'écran énigme
     * - riddleQuestion  : texte de l'énigme
     * - hint            : indice révélé si on clique sur "indice"
     * - answers         : réponses acceptées (on ignore majuscules/accents)
     *
     * - briefingTitle   : titre écran briefing
     * - briefingText    : texte mission/consigne à lire APRÈS la bonne réponse
     *
     * - destinationTitle: titre écran destination
     * - destinationText : texte qui dit où aller ensuite
     */

    const STEPS = {
      "1": {
        riddleTitle: "Énigme #1",
        riddleQuestion: "Je parle sans bouche et j'entends sans oreilles. Je n'ai pas de corps, mais je prends vie avec le vent. Qui suis-je ?",
        hint: "Pense au son qui revient quand tu cries dans une grotte.",
        answers: ["echo", "l'echo", "l echo", "echo."],

        briefingTitle: "Briefing #1",
        briefingText: "Bravo. Voici votre mission secrète : trouvez le mot de passe gravé sous le banc rouge. Vous en aurez besoin plus tard. Ne le dites pas aux autres équipes.",

        destinationTitle: "Destination suivante",
        destinationText: "Rendez-vous sous l'arche en pierre près de la fontaine. C'est là-bas que commence l'étape 2."
      },

      "2": {
        riddleTitle: "Énigme #2",
        riddleQuestion: "Plus je suis grand, moins tu me vois. Qui suis-je ?",
        hint: "C'est l'absence de lumière.",
        answers: ["obscurite","l'obscurite","la nuit","nuit"],

        briefingTitle: "Briefing #2",
        briefingText: "OK équipe. Vous devez maintenant
